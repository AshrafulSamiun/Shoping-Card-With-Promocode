<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shoping Card</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>
    <header>
        <nav class="navbar fixed-top navbar-expand-lg navbar-dard">
            <div class="container">
                <a class="navbar-brand" href="#">Tech Shop</a>

                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                        <li class="nav-item">
                            <a class="nav-link active" aria-current="page" href="checkout.html">
                               
                                <i class="fa-solid fa-cart-shopping text-warning" style="position: relative;">
                                    <span style="position:absolute; top:-10px; padding: 4px; border-radius: 30%;
                                     background-color:rgb(247, 186, 6) !important; color: #fff; font-size: 6px;" id="card-quantity">0</span>
                                </i></a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="index.html">Product</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#skills">Support</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="checkout.html">Check Out</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#contact">Contact</a>
                        </li>


                    </ul>

                </div>
            </div>
        </nav>
    </header>
    <main>

        <section style="margin-top: 100px;">
            <div class="container my-5" >
               

                <div class="row" >
                    <!-- Cart Items Section -->
                    <div class="col-md-8  mb-5" id="product_container">
                        <!-- Select All and Delete -->
                        <div class="d-flex justify-content-between">
                            <div>
                                <input type="checkbox" onclick="checked_items_all()"> SELECT ALL (<span id="card_items_total">0</span> ITEM(S))
                            </div>
                            <button class="btn btn-link text-danger" onclick="delete_items()">üóëÔ∏è DELETE</button>
                        </div>
            
                       
                    </div>
            
                    <!-- Order Summary Section -->
                    <div class="col-md-4">
                        <div class="border p-3">
                            <h6>Location</h6>
                            <a href="#" class="text-decoration-none"><i class="bi bi-geo-alt"></i> Add Shipping Address</a>
                            <hr>
                            <h6>Order Summary</h6>
                            <div class="d-flex justify-content-between">
                                <span>Subtotal (<span id="subtotal_item">0</span> items)</span>
                                <span>‡ß≥ <span id="subtotal_amount">0</span></span>
                            </div>
                            <div class="d-flex justify-content-between">
                                <span>Shipping Fee</span>
                                <span>‡ß≥ 150</span>
                            </div>
                            <input type="text" id="promo_code" name="promo_code" class="form-control mt-2" placeholder="Enter Promo Code">
                            <button class="btn btn-primary w-100 mt-2" onclick="apply_promocode()">APPLY</button>
                            <hr>
                            <div class="d-flex justify-content-between">
                                <strong>Total</strong>
                                <strong class="text-danger">‡ß≥ <span id="total_amount"> 0</span></strong>
                            </div>
                            <button class="btn btn-warning text-white w-100 mt-2">PROCEED TO CHECKOUT (0)</button>
                            <input type="hidden" id="hidden_subtotal" name="hidden_subtotal" />
                       
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>
            
    

    <footer class="bg-light pt-4 py-4 text-center">

        <div class="container ">
            <a href="" class="me-3" >
                <i class="fa-brands fa-facebook fa-2x"></i>
            </a>
            <a href="" class="me-3" >
                <i class="fa-brands fa-instagram fa-2x"></i>
            </a>
            <a href="" class="me-3" >
                <i class="fa-brands fa-twitter fa-2x"></i>
            </a>
            <a href="" class="me-3" >
                <i class="fa-brands fa-linkedin fa-2x"></i>
            </a>
        </div>
        <p>
            &copy; 2025 all right reserved
        </p>
        <div>

        </div>
        
    </footer>
    <script>
        // Fetch the JSON file

        function apply_promocode()
        {
            let promo_code=document.getElementById("promo_code").value;

            if(promo_code=="ostad10" || promo_code=="ostad5")
            {
                let subtotal_amount=document.getElementById("hidden_subtotal").value*1;
                let discount=0;
                if(promo_code=="ostad10")  discount=10;
                else  discount=5;
               // console.log(subtotal_amount);
               // subtotal_amount=subtotal_amount-(subtotal_amount*discount/100);
               // console.log(subtotal_amount);
                let total_amount=subtotal_amount+150;
                total_amount=(total_amount-(total_amount*discount/100)).toFixed(2);
               // document.getElementById("subtotal_amount").innerHTML=subtotal_amount.toFixed(2);
                document.getElementById("total_amount").innerHTML=total_amount;
            }
            else{
                alert(" Invalid Promo Code , Please try with Valid One !")
            }

        }
        function fetch_product()
        {
            let products = JSON.parse(localStorage.getItem("products")) || [];
            let product_container=document.getElementById("product_container");

            let total_amount=0;
            let total_items=0;
            let checkout_qty=0;
            products.forEach(product => {
                const newCol = document.createElement('div');
                newCol.className = 'border p-3 mb-3';
                let product_string=JSON.stringify(product);

                let product_checked="";
              

                if(product.is_checked==true){
                    product_checked="checked";
                    total_items+=product.quantity;
                    total_amount+=product.quantity*product.price;
                }

                checkout_qty+=product.quantity;
                newCol.innerHTML = `<div class="mb-2">
                                        <strong>${product.title}</strong>
                                    </div>
                                    <div class="d-flex">
                                        <input type="checkbox" onchange='change_status(${product_string},this)' class="me-2"
                                        ${product_checked}>
                                        <img src="${product.image}" alt="Product Image" width="100" hieght="100" class="me-3">
                                        <div class="flex-grow-1">
                                            <h6>${product.title}</h6>
                                            <p class="mb-1 text-muted">${product.description}</p>
                                            <p class="mb-1 text-warning">Ends at Feb 15 23:59:59</p>
                                            <button class="btn btn-warning btn-sm text-white">HOT ITEM</button>
                                        </div>
                                        <div class="text-end">
                                            <h5 class="text-danger">‡ß≥ ${product.price}</h5>
                                            <p class="text-muted text-decoration-line-through">‡ß≥ 600</p>
                                            <div class="mt-3" >
                                                <button class="btn btn-light border" onclick='decrease_quantity(${product_string})'>‚àí</button>
                                                <span class="mx-2" id="productQuantity${product.id}"> ${product.quantity}</span>
                                                <button class="btn btn-light border" onclick='increase_quantity(${product_string})'>+</button>
                                            </div>
                                        </div>
                                    </div>`;
                
                product_container.appendChild(newCol);

            });

            let grand_total=total_amount+150;
            document.getElementById("card_items_total").innerHTML=checkout_qty;
            document.getElementById("total_amount").innerHTML=grand_total;
            document.getElementById("card-quantity").innerHTML=total_items;
            document.getElementById("subtotal_item").innerHTML=total_items;
            document.getElementById("subtotal_amount").innerHTML=total_amount;
            document.getElementById("hidden_subtotal").value=total_amount;
            

            
        }

        window.onload = fetch_product;
       

        function delete_items()
        {
            

            let products =  []
            localStorage.setItem("products",JSON.stringify(products));

            let total_amount=0;
            let total_items=0;
            
            
            let grand_total=total_amount+150;
            document.getElementById("card_items_total").innerHTML=0;
            document.getElementById("total_amount").innerHTML=grand_total;
            document.getElementById("card-quantity").innerHTML=total_items;
            document.getElementById("subtotal_item").innerHTML=total_items;
            document.getElementById("subtotal_amount").innerHTML=total_amount;
            document.getElementById("hidden_subtotal").value=total_amount;
            fetch_product();
        }

        function increase_quantity(product,button)
        {
           // product = JSON.parse(JSON.stringify(product));
           
            product.quantity++;

            const span = document.getElementById('productQuantity'+product.id);
            span.innerHTML = product.quantity;
            console.log(product.quantity)

            let products = JSON.parse(localStorage.getItem("products")) || [];
            products = products.map(p => p.id === product.id ? product : p);
          
            localStorage.setItem("products",JSON.stringify(products));

            let total_amount=0;
            let total_items=0;
            products.forEach(product=>{
                if(product.is_checked==true){
                    total_items+=product.quantity;
                    total_amount+=product.quantity*product.price;
                }
            });
            
            let grand_total=total_amount+150;
            document.getElementById("card_items_total").innerHTML=checkout_qty;
            document.getElementById("total_amount").innerHTML=grand_total;
            document.getElementById("card-quantity").innerHTML=total_items;
            document.getElementById("subtotal_item").innerHTML=total_items;
            document.getElementById("subtotal_amount").innerHTML=total_amount;
            document.getElementById("hidden_subtotal").value=total_amount;
        }

        function decrease_quantity(product)
        {
           // product = JSON.parse(JSON.stringify(product));
            if(product.quantity==1){
                return false;
            }
            product.quantity--;

            const span = document.getElementById('productQuantity'+product.id);
           
            span.innerHTML = product.quantity;
           

            let products = JSON.parse(localStorage.getItem("products")) || [];
            products = products.map(p => p.id === product.id ? product : p);
          
            localStorage.setItem("products",JSON.stringify(products));
            let total_amount=0;
            let total_items=0;
            products.forEach(product=>{
                if(product.is_checked==true){
                    total_items+=product.quantity;
                    total_amount+=product.quantity*product.price;
                }
            });
           
            let grand_total=total_amount+150;
            document.getElementById("card_items_total").innerHTML=checkout_qty;
            document.getElementById("total_amount").innerHTML=grand_total;
            document.getElementById("card-quantity").innerHTML=total_items;
            document.getElementById("subtotal_item").innerHTML=total_items;
            document.getElementById("subtotal_amount").innerHTML=total_amount;
            document.getElementById("hidden_subtotal").value=total_amount;
        }

        function checked_items_all()
        {
            
            
            let products = JSON.parse(localStorage.getItem("products")) || [];
          
            localStorage.setItem("products",JSON.stringify(products));

            let total_amount=0;
            let total_items=0;
            let newProducts=[];
            products.forEach(product=>{
                product.is_checked==true;
                total_items+=product.quantity;
                total_amount+=product.quantity*product.price;
                newProducts.push(product);
                
            });
           
            localStorage.setItem("products",JSON.stringify(newProducts));
            let grand_total=total_amount+150;
            document.getElementById("total_amount").innerHTML=grand_total;
            document.getElementById("card-quantity").innerHTML=total_items;
            document.getElementById("subtotal_item").innerHTML=total_items;
            document.getElementById("subtotal_amount").innerHTML=total_amount;
            document.getElementById("hidden_subtotal").value=total_amount;

        }

        function change_status(product,checkbox)
        {
            if (checkbox.checked)
            {
                product.is_checked=true;
            }
            else{
                product.is_checked=false;
            }
            
            let products = JSON.parse(localStorage.getItem("products")) || [];
            products = products.map(p => p.id === product.id ? product : p);
          
            localStorage.setItem("products",JSON.stringify(products));

            let total_amount=0;
            let total_items=0;
            products.forEach(product=>{
                if(product.is_checked==true){
                    total_items+=product.quantity;
                    total_amount+=product.quantity*product.price;
                }
            });
           
            let grand_total=total_amount+150;
            document.getElementById("total_amount").innerHTML=grand_total;
            document.getElementById("card-quantity").innerHTML=total_items;
            document.getElementById("subtotal_item").innerHTML=total_items;
            document.getElementById("subtotal_amount").innerHTML=total_amount;
            document.getElementById("hidden_subtotal").value=total_amount;

        }


        function view_product(data){
            const productContainer = document.getElementById('product-container');

            const newCol = document.createElement('div');
            newCol.className = 'col-lg-3 col-md-4 col-sm-6 col-sx-12';
            const maxLength = 100;
            const trimmedText = data.description.length > maxLength ? data.description.substring(0, maxLength) + '...' : data.description;
            
            let description
            newCol.innerHTML = `<div class="card my-3" style=" ">
                                    <img src="${data.image}" class="img-fluid" alt="..." style="height: 400px !important; width:100%">
                                    <div class="card-body" style="min-height:15rem">
                                        <h5 class="card-title">${data.title}</h5>
                                        <p class="card-text text-wrap">
                                            ${trimmedText}
                                            <button class="btn btn-link p-2" id="read-more-btn" style="">Read More</button>
                                        </p>
                                        
                                            <p class="card-text">Price:$ ${data.price}</p>
                                        <a href="#" class="btn btn-primary">Add To Card</a>
                                    </div>
                                </div>`;

            // Append the new div to the parent
            productContainer.appendChild(newCol);

        }


    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>
